(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{105:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r(12),c=r.n(n),i=r(34),o=r(78),s=r(150),l=r(151),u=r(152),d=r(59),b=r(58),j=r(27),p=r.n(j),O=r(42),m=r(11),h=r(60),f=r(143),x=r(145),v=r(161),g=r(147),y=r(46),T=r(154),k=r(140),w=r(158),S=r(135),I=r(159),C=r(157),P=r(160),E=r(141),F=r(142),N=r(144),U=r(146),q=r(71),z=r(6),A=function(e){var t=e.value,r=e.normalize,a=e.validate,n=e.errorText,c=e.okText;r&&(t=r(t));var i=!!a&&!a(t);return{value:t,error:i,helperText:i?n:c}},D=function(e){var t=e.dialogParams,r=e.setDialogParams,n=e.dialogFields,c=e.setDialogFields,i=Object(a.useCallback)((function(e){var t,r=e.target,a=r.id,i=r.name,o=a||i,s=n.findIndex((function(e){return e.id===o})),l=n[s],u=l.type;switch(l.controlType){case"Checkbox":t=e.target.checked;break;case"Input":"file"===u&&(t=e.target.files[0]);break;default:t=e.target.value}var d=A(Object(m.a)(Object(m.a)({},l),{},{value:t})),b=d.value,j=d.error,p=d.helperText;c([].concat(Object(y.a)(n.slice(0,s)),[Object(m.a)(Object(m.a)({},n[s]),{},{value:b,error:j,helperText:p})],Object(y.a)(n.slice(s+1))))}),[n,c]),o=Object(a.useCallback)((function(){var e=Object(y.a)(n);e.forEach((function(e){var t=A(e),r=t.value,a=t.error,n=t.helperText;e.value=r,e.error=a,e.helperText=n})),c(Object(y.a)(e)),function(e){var t,r=Object(q.a)(e);try{for(r.s();!(t=r.n()).done;)if(t.value.error)return!1}catch(a){r.e(a)}finally{r.f()}return!0}(e)&&r(Object(m.a)(Object(m.a)({},t),{},{okPressed:!0,loading:!0}))}),[t,n,r,c]),s=Object(a.useCallback)((function(){r(Object(m.a)(Object(m.a)({},t),{},{open:!1,okPressed:!1}))}),[t,r]),l=Object(a.useCallback)((function(e,t){var r={};switch(r.id=e.id,r.onChange=i,r.autoFocus=0===t,e.controlType){case"TextField":return r.label=e.label,r.type=e.type,r.defaultValue=e.value,r.required=e.required,r.helperText=e.helperText,r.error=e.error,r.margin="normal",r.fullWidth=!0,r.onFocus=function(e){e.target.select()},"time"===e.type&&(r.InputLabelProps={shrink:!0},r.inputProps={step:60*e.step}),Object(z.jsx)(T.a,Object(m.a)({},r));case"Checkbox":return r.checked=e.value,Object(z.jsx)(k.a,{control:Object(z.jsx)(w.a,Object(m.a)({color:"primary"},r)),label:e.label});case"Input":return r.type=e.type,r.required=e.required,r.error=e.error,r.inputProps={accept:e.accept},Object(z.jsx)(S.a,Object(m.a)({},r));case"Radio":return Object(z.jsx)(I.a,{value:e.value,row:!0,children:e.arrValues.map((function(t){return Object(a.createElement)(k.a,Object(m.a)(Object(m.a)({},r),{},{key:t,value:t,control:Object(z.jsx)(C.a,{color:"primary"}),name:e.id,label:t}))}))})}return null}),[i]);return Object(z.jsxs)(P.a,{open:t.open,onEscapeKeyDown:s,children:[Object(z.jsx)(E.a,{children:t.title}),Object(z.jsx)(F.a,{children:Object(z.jsx)(f.a,{container:!0,direction:"column",children:n.map((function(e,t){return Object(z.jsx)("li",{style:{listStyleType:"none"},children:l(e,t)},e.id)}))})}),Object(z.jsxs)(N.a,{children:[!t.loading&&Object(z.jsx)(x.a,{onClick:o,children:"Ok"}),t.loading&&Object(z.jsx)(U.a,{color:"primary"}),Object(z.jsx)(x.a,{onClick:s,children:"Cancel"})]})]})},_=r(76),L=function e(){var t=this;Object(_.a)(this,e),this.fields=[{id:"name",label:"Name:",controlType:"TextField",type:"text",required:!0,value:"",error:!1,helperText:"",okText:"",normalize:function(e){return e.trim()},validate:function(e){return 0!==e.length},errorText:"Shouldn't be empty"},{id:"surname",label:"Surname:",controlType:"TextField",type:"text",required:!0,value:"",error:!1,helperText:"",okText:"",normalize:function(e){return e.trim()},validate:function(e){return 0!==e.length},errorText:"Shouldn't be empty"},{id:"email",label:"E-mail:",controlType:"TextField",type:"text",required:!0,value:"",error:!1,helperText:"",okText:"",normalize:function(e){return e.trim()},validate:function(e){return 0!==e.length},errorText:"Shouldn't be empty"},{id:"password",label:"Password:",controlType:"TextField",type:"password",required:!0,value:"",error:!1,helperText:"",okText:"",normalize:function(e){return e.trim()},validate:function(e){return e.length>=4},errorText:"Should be at least 4 symbols"},{id:"role",controlType:"Radio",type:"text",required:!0,value:"user",arrValues:["admin","user"],error:!1}],this.getFields=function(e){return t.fields.filter((function(t){return e.includes(t.id)}))}},G="https://anna-shvetsova.h1n.ru/api/users",H=function(e){return function(t){t({type:"AUTHENTICATE",payload:e})}},J=function(e){var t=e.name,r=e.surname,a=e.email,n=e.password,c=e.role;return function(){var e=Object(O.a)(p.a.mark((function e(i){var o,s,l,u,d;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(G,"/signUp"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t,surname:r,email:a,password:n,role:c})});case 2:return o=e.sent,e.next=5,o.json();case 5:if(s=e.sent,l=s.status,u=s.message,d=s.data,"success"===l){e.next=11;break}throw Error(u);case 11:i(H(d));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},V=function(e){var t=e.email,r=e.password;return function(){var e=Object(O.a)(p.a.mark((function e(a){var n,c,i,o,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(G,"/signIn"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t,password:r})});case 2:return n=e.sent,e.next=5,n.json();case 5:if(c=e.sent,i=c.status,o=c.message,s=c.data,"success"===i){e.next=11;break}throw Error(o);case 11:a(H(s));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},R=function(){var e=Object(i.c)((function(e){return e}))._id,t=Object(i.b)(),r=Object(a.useState)({open:!1,message:""}),n=Object(h.a)(r,2),c=n[0],o=n[1],s={open:!1,title:"",mode:void 0,okPressed:!1,loading:!1},l=Object(a.useState)(s),u=Object(h.a)(l,2),d=u[0],b=u[1],j=Object(a.useState)([]),y=Object(h.a)(j,2),T=y[0],k=y[1],w=Object(a.useCallback)((function(e){var t="signUp"===e?["name","surname","email","password","role"]:["email","password"];return(new L).getFields(t)}),[]),S=Object(a.useCallback)(function(){var e=Object(O.a)(p.a.mark((function e(r,a){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t(r(a));case 3:b(Object(m.a)(Object(m.a)({},d),{},{okPressed:!1,open:!1})),e.next=21;break;case 6:e.prev=6,e.t0=e.catch(0),n="",e.t1=e.t0.message,e.next="INVALID_PASSWORD"===e.t1?12:"EMAIL_NOT_FOUND"===e.t1?14:"EMAIL_EXISTS"===e.t1?16:18;break;case 12:return n="Pair email/password isn't correct",e.abrupt("break",19);case 14:return n="There is no user registered under such email",e.abrupt("break",19);case 16:return n="User with such an email already exists",e.abrupt("break",19);case 18:n=e.t0.message;case 19:o({open:!0,message:n}),b(Object(m.a)(Object(m.a)({},d),{},{okPressed:!1,loading:!1}));case 21:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,r){return e.apply(this,arguments)}}(),[d,b,t]);return Object(a.useEffect)((function(){if(d.okPressed){var e=function(e){var t={};return e.forEach((function(e){t[e.id]=e.value})),t}(T);switch(d.mode){case"SIGNUP":S(J,e);break;case"SIGNIN":S(V,e)}}}),[d,T,S]),Object(z.jsxs)(a.Fragment,{children:[Object(z.jsxs)(f.a,{container:!0,direction:"row",justify:"flex-end",alignItems:"center",children:[!e&&Object(z.jsx)(x.a,{onClick:function(){k(w("signUp")),b(Object(m.a)(Object(m.a)({},s),{},{open:!0,title:"Signing up",mode:"SIGNUP"}))},children:"Sign up"}),!e&&Object(z.jsx)(x.a,{onClick:function(){k(w("signIn")),b(Object(m.a)(Object(m.a)({},s),{},{open:!0,title:"Signing in",mode:"SIGNIN"}))},children:"Sign in"}),e&&Object(z.jsx)(x.a,{onClick:function(){t({type:"LOGOUT"})},children:"Log out"})]}),d.open&&Object(z.jsx)(D,{dialogParams:d,setDialogParams:b,dialogFields:T,setDialogFields:k}),Object(z.jsx)(v.a,{open:c.open,message:c.message,anchorOrigin:{vertical:"top",horizontal:"center"},autoHideDuration:6e3,onClose:function(){return o({open:!1})},action:Object(z.jsx)(a.Fragment,{children:Object(z.jsx)(x.a,{size:"small","aria-label":"close",color:"secondary",onClick:function(){return o({open:!1})},children:Object(z.jsx)(g.a,{})})})})]})},W=r(155),M=r(81),B=r(148),K=r(149),X=function(){var e=Object(i.c)((function(e){return e})),t=e._id,r=e.name,a=e.surname,n=e.role,c=t?"Hello ".concat(r," ").concat(a):"Authenticate please";return Object(z.jsxs)(f.a,{container:!0,direction:"column",alignItems:"center",children:[Object(z.jsxs)(W.a,{mt:.2,mb:.2,children:[t&&"admin"===n&&Object(z.jsx)(B.a,{color:"primary",fontSize:"large"}),t&&"user"===n&&Object(z.jsx)(K.a,{color:"primary",fontSize:"large"})]}),Object(z.jsx)(M.a,{component:"p",children:c})]})},Q=function(){return Object(z.jsxs)("div",{className:"app",children:[Object(z.jsx)(R,{}),Object(z.jsx)(X,{})]})},Y=r(41),Z=r(77),$=function(e,t){var r={_id:null,name:null,surname:null,email:null,role:null};if(void 0===e)return r;switch(t.type){case"AUTHENTICATE":var a=t.payload,n=a._id,c=a.name,i=a.surname,o=a.email,s=a.role;return Object(m.a)(Object(m.a)({},e),{},{_id:n,name:c,surname:i,email:o,role:s});case"LOGOUT":return r;default:return e}},ee=Object(Y.c)($,Object(Y.a)(Z.a)),te=Object(o.a)({palette:{type:"dark",primary:{main:d.a[200]},error:{main:b.a[200]}}});c.a.render(Object(z.jsxs)(s.a,{theme:te,children:[Object(z.jsx)(l.a,{}),Object(z.jsx)(u.a,{maxWidth:"sm",children:Object(z.jsx)(i.a,{store:ee,children:Object(z.jsx)(Q,{})})})]}),document.getElementById("root"))}},[[105,1,2]]]);
//# sourceMappingURL=main.805287ba.chunk.js.map